(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{98:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return b})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return r}));var i=a(2),c=a(6),n=(a(0),a(236)),l={title:"Security Checklist"},b={unversionedId:"checklists/backend/backend-security-checklist/production-security-checklist",id:"checklists/backend/backend-security-checklist/production-security-checklist",isDocsHomePage:!1,title:"Security Checklist",description:"Checklist of the most important security countermeasures when designing, testing, and releasing your API.",source:"@site/docs/checklists/backend/backend-security-checklist/production-security-checklist.md",slug:"/checklists/backend/backend-security-checklist/production-security-checklist",permalink:"/docs/checklists/backend/backend-security-checklist/production-security-checklist",version:"current",sidebar:"docs",previous:{title:"Production Ready Checklist",permalink:"/docs/checklists/backend/backend-production-ready/production-ready-checklist"},next:{title:"Design Checklist",permalink:"/docs/checklists/frontend/frontend-design-checklist/frontend-design-checklist"}},s=[{value:"Authentication",id:"authentication",children:[{value:"JWT (JSON Web Token)",id:"jwt-json-web-token",children:[]},{value:"OAuth",id:"oauth",children:[]}]},{value:"Access",id:"access",children:[]},{value:"Input",id:"input",children:[]},{value:"Processing",id:"processing",children:[]},{value:"Output",id:"output",children:[]},{value:"CI &amp; CD",id:"ci--cd",children:[]},{value:"See also:",id:"see-also",children:[]}],o={rightToc:s};function r(e){var t=e.components,a=Object(c.a)(e,["components"]);return Object(n.b)("wrapper",Object(i.a)({},o,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)("p",null,"Checklist of the most important security countermeasures when designing, testing, and releasing your API."),Object(n.b)("hr",null),Object(n.b)("h2",{id:"authentication"},"Authentication"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Don't use ",Object(n.b)("inlineCode",{parentName:"li"},"Basic Auth"),". Use standard authentication instead (e.g. ",Object(n.b)("a",Object(i.a)({parentName:"li"},{href:"https://jwt.io/"}),"JWT"),", ",Object(n.b)("a",Object(i.a)({parentName:"li"},{href:"https://oauth.net/"}),"OAuth"),")."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Don't reinvent the wheel in ",Object(n.b)("inlineCode",{parentName:"li"},"Authentication"),", ",Object(n.b)("inlineCode",{parentName:"li"},"token generation"),", ",Object(n.b)("inlineCode",{parentName:"li"},"password storage"),". Use the standards."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use ",Object(n.b)("inlineCode",{parentName:"li"},"Max Retry")," and jail features in Login."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use encryption on all sensitive data.")),Object(n.b)("h3",{id:"jwt-json-web-token"},"JWT (JSON Web Token)"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use a random complicated key (",Object(n.b)("inlineCode",{parentName:"li"},"JWT Secret"),") to make brute forcing the token very hard."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Don't extract the algorithm from the header. Force the algorithm in the backend (",Object(n.b)("inlineCode",{parentName:"li"},"HS256")," or ",Object(n.b)("inlineCode",{parentName:"li"},"RS256"),")."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Make token expiration (",Object(n.b)("inlineCode",{parentName:"li"},"TTL"),", ",Object(n.b)("inlineCode",{parentName:"li"},"RTTL"),") as short as possible."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Don't store sensitive data in the JWT payload, it can be decoded ",Object(n.b)("a",Object(i.a)({parentName:"li"},{href:"https://jwt.io/#debugger-io"}),"easily"),".")),Object(n.b)("h3",{id:"oauth"},"OAuth"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Always validate ",Object(n.b)("inlineCode",{parentName:"li"},"redirect_uri")," server-side to allow only whitelisted URLs."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Always try to exchange for code and not tokens (don't allow ",Object(n.b)("inlineCode",{parentName:"li"},"response_type=token"),")."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use ",Object(n.b)("inlineCode",{parentName:"li"},"state")," parameter with a random hash to prevent CSRF on the OAuth authentication process."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Define the default scope, and validate scope parameters for each application.")),Object(n.b)("h2",{id:"access"},"Access"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Limit requests (Throttling) to avoid DDoS / brute-force attacks."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use HTTPS on server side to avoid MITM (Man in the Middle Attack)."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use ",Object(n.b)("inlineCode",{parentName:"li"},"HSTS")," header with SSL to avoid SSL Strip attack.")),Object(n.b)("h2",{id:"input"},"Input"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use the proper HTTP method according to the operation: ",Object(n.b)("inlineCode",{parentName:"li"},"GET (read)"),", ",Object(n.b)("inlineCode",{parentName:"li"},"POST (create)"),", ",Object(n.b)("inlineCode",{parentName:"li"},"PUT/PATCH (replace/update)"),", and ",Object(n.b)("inlineCode",{parentName:"li"},"DELETE (to delete a record)"),", and respond with ",Object(n.b)("inlineCode",{parentName:"li"},"405 Method Not Allowed")," if the requested method isn't appropriate for the requested resource."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Validate ",Object(n.b)("inlineCode",{parentName:"li"},"content-type")," on request Accept header (Content Negotiation) to allow only your supported format (e.g. ",Object(n.b)("inlineCode",{parentName:"li"},"application/xml"),", ",Object(n.b)("inlineCode",{parentName:"li"},"application/json"),", etc.) and respond with ",Object(n.b)("inlineCode",{parentName:"li"},"406 Not Acceptable")," response if not matched."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Validate ",Object(n.b)("inlineCode",{parentName:"li"},"content-type")," of posted data as you accept (e.g. ",Object(n.b)("inlineCode",{parentName:"li"},"application/x-www-form-urlencoded"),", ",Object(n.b)("inlineCode",{parentName:"li"},"multipart/form-data"),", ",Object(n.b)("inlineCode",{parentName:"li"},"application/json"),", etc.)."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Validate user input to avoid common vulnerabilities (e.g. ",Object(n.b)("inlineCode",{parentName:"li"},"XSS"),", ",Object(n.b)("inlineCode",{parentName:"li"},"SQL-Injection"),", ",Object(n.b)("inlineCode",{parentName:"li"},"Remote Code Execution"),", etc.)."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Don't use any sensitive data (",Object(n.b)("inlineCode",{parentName:"li"},"credentials"),", ",Object(n.b)("inlineCode",{parentName:"li"},"Passwords"),", ",Object(n.b)("inlineCode",{parentName:"li"},"security tokens"),", or ",Object(n.b)("inlineCode",{parentName:"li"},"API keys"),") in the URL, but use standard Authorization header."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use an API Gateway service to enable caching, Rate Limit policies (e.g. ",Object(n.b)("inlineCode",{parentName:"li"},"Quota"),", ",Object(n.b)("inlineCode",{parentName:"li"},"Spike Arrest"),", or ",Object(n.b)("inlineCode",{parentName:"li"},"Concurrent Rate Limit"),") and deploy APIs resources dynamically.")),Object(n.b)("h2",{id:"processing"},"Processing"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Check if all the endpoints are protected behind authentication to avoid broken authentication process."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","User own resource ID should be avoided. Use ",Object(n.b)("inlineCode",{parentName:"li"},"/me/orders")," instead of ",Object(n.b)("inlineCode",{parentName:"li"},"/user/654321/orders"),"."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Don't auto-increment IDs. Use ",Object(n.b)("inlineCode",{parentName:"li"},"UUID")," instead."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","If you are parsing XML files, make sure entity parsing is not enabled to avoid ",Object(n.b)("inlineCode",{parentName:"li"},"XXE")," (XML external entity attack)."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","If you are parsing XML files, make sure entity expansion is not enabled to avoid ",Object(n.b)("inlineCode",{parentName:"li"},"Billion Laughs/XML bomb")," via exponential entity expansion attack."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use a CDN for file uploads."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","If you are dealing with huge amount of data, use Workers and Queues to process as much as possible in background and return response fast to avoid HTTP Blocking."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Do not forget to turn the DEBUG mode OFF.")),Object(n.b)("h2",{id:"output"},"Output"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Send ",Object(n.b)("inlineCode",{parentName:"li"},"X-Content-Type-Options: nosniff")," header."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Send ",Object(n.b)("inlineCode",{parentName:"li"},"X-Frame-Options: deny")," header."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Send ",Object(n.b)("inlineCode",{parentName:"li"},"Content-Security-Policy: default-src 'none'")," header."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Remove fingerprinting headers - ",Object(n.b)("inlineCode",{parentName:"li"},"X-Powered-By"),", ",Object(n.b)("inlineCode",{parentName:"li"},"Server"),", ",Object(n.b)("inlineCode",{parentName:"li"},"X-AspNet-Version"),", etc."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Force ",Object(n.b)("inlineCode",{parentName:"li"},"content-type")," for your response. If you return ",Object(n.b)("inlineCode",{parentName:"li"},"application/json"),", then your ",Object(n.b)("inlineCode",{parentName:"li"},"content-type")," response is ",Object(n.b)("inlineCode",{parentName:"li"},"application/json"),"."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Don't return sensitive data like ",Object(n.b)("inlineCode",{parentName:"li"},"credentials"),", ",Object(n.b)("inlineCode",{parentName:"li"},"Passwords"),", or ",Object(n.b)("inlineCode",{parentName:"li"},"security tokens"),"."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Return the proper status code according to the operation completed. (e.g. ",Object(n.b)("inlineCode",{parentName:"li"},"200 OK"),", ",Object(n.b)("inlineCode",{parentName:"li"},"400 Bad Request"),", ",Object(n.b)("inlineCode",{parentName:"li"},"401 Unauthorized"),", ",Object(n.b)("inlineCode",{parentName:"li"},"405 Method Not Allowed"),", etc.).")),Object(n.b)("h2",{id:"ci--cd"},"CI & CD"),Object(n.b)("ul",{className:"contains-task-list"},Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Audit your design and implementation with unit/integration tests coverage."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Use a code review process and disregard self-approval."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Ensure that all components of your services are statically scanned by AV software before pushing to production, including vendor libraries and other dependencies."),Object(n.b)("li",Object(i.a)({parentName:"ul"},{className:"task-list-item"}),Object(n.b)("input",Object(i.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Design a rollback solution for deployments.")),Object(n.b)("hr",null),Object(n.b)("h2",{id:"see-also"},"See also:"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("a",Object(i.a)({parentName:"li"},{href:"https://github.com/yosriady/api-development-tools"}),"yosriady/api-development-tools")," - A collection of useful resources for building RESTful HTTP+JSON APIs.")),Object(n.b)("hr",null))}r.isMDXComponent=!0}}]);