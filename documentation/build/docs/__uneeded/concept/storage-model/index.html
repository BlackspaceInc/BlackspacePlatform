<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=3">
<meta httpequiv="x-ua-compatible" content="ie=edge">
<meta property="og:type" content="website">
<meta name="author" content="BlackspaceInc">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@Blackspace">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<link href="https://www.googletagmanager.com" rel="dns-prefetch">
<link href="https://www.google-analytics.com" rel="dns-prefetch">
<link rel="shortcut icon" href="https://BlackspaceInc.github.io/img/favicon.png">
<link rel="apple-touch-icon" sizes="48x48" href="/img/icons/icon-48x48.png">
<link rel="apple-touch-icon" sizes="72x72" href="/img/icons/icon-72x72.png">
<link rel="apple-touch-icon" sizes="96x96" href="/img/icons/icon-96x96.png">
<link rel="apple-touch-icon" sizes="144x144" href="/img/icons/icon-144x144.png">
<link rel="apple-touch-icon" sizes="192x192" href="/img/icons/icon-192x192.png">
<link rel="apple-touch-icon" sizes="256x256" href="/img/icons/icon-256x256.png">
<link rel="apple-touch-icon" sizes="384x384" href="/img/icons/icon-384x384.png">
<link rel="apple-touch-icon" sizes="512x512" href="/img/icons/icon-512x512.png">
<link rel="sitemap" type="application/xml" href="/sitemap.xml">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Internal Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Internal Documentation Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-PVR7M2G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-PVR7M2G",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Internal Documentation" href="/opensearch.xml"><title data-react-helmet="true">Storage model | Internal Documentation</title><meta data-react-helmet="true" property="og:image" content="https://BlackspaceInc.github.io/img/og.png"><meta data-react-helmet="true" name="twitter:image" content="https://BlackspaceInc.github.io/img/og.png"><meta data-react-helmet="true" name="twitter:description" content="Blackspace is an ecommerce platform empowering minoriting owned businesses to achieve more"><meta data-react-helmet="true" name="twitter:title" content="Introduction | Internal Documentation"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for &quot;Introduction | Internal Documentation&quot;"><meta data-react-helmet="true" property="og:title" content="Storage model | Internal Documentation"><meta data-react-helmet="true" name="description" content="Overview of QuestDB&#x27;s column-based storage model. It ensures ACID properties while keeping low overhead for maximum performance."><meta data-react-helmet="true" property="og:description" content="Overview of QuestDB&#x27;s column-based storage model. It ensures ACID properties while keeping low overhead for maximum performance."><meta data-react-helmet="true" property="og:url" content="https://BlackspaceInc.github.io/docs/__uneeded/concept/storage-model"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://BlackspaceInc.github.io/docs/__uneeded/concept/storage-model"><link rel="stylesheet" href="/styles.57a3982d.css">
</head>
<body itemscope="" itemtype="http://schema.org/Organization">
<meta itemprop="name" content="Ecommerce platform empowering minority owned businesses to achieve more">
<meta itemprop="description" content="Blackspace is an ecommerce platform empowering minoriting owned businesses to achieve more">
<meta itemprop="url" content="https://BlackspaceInc.github.io">
<meta itemprop="logo" content="https://BlackspaceInc.github.io/img/favicon.png">
<meta itemprop="sameAs" content="https://twitter.com/blackspace">
<meta itemprop="sameAs" content="https://www.linkedin.com/company/blackspaceInc/">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand brand_9Wyn" href="/"><img alt="Blackspace" class="navbar__logo" src="/img/navbar/logo.ico"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Getting Started</a><ul class="dropdown__menu"><li><a class="dropdown__link" position="left" href="/docs/guide/docker/">Docker</a></li><li><a class="dropdown__link" position="left" href="/docs/guide/kubernetes/">Kubernetes</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/BlackspaceInc/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--github">GitHub</a><a href="https://blackspace.slack.com/join/shared_invite/enQtNzk4Nzg4Mjc2MTE2LTEzZThjMzliMjUzMTBmYzVjYWNmM2UyNWJmNDdkMDYyZmE0ZDliZTQxN2EzNzk5MDE3Zjc1ZmJiZmFiZTIwMGY#/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--slack">Join Slack</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button><a class="getStarted_1xnS button_Ni2_ button--primary_316O button--uppercase_35Ce button--xsmall_3jz_" href="/getstarted/">Get Started</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand brand_9Wyn" href="/"><img alt="Blackspace" class="navbar__logo" src="/img/navbar/logo.ico"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/guide/docker/">Docker</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/guide/kubernetes/">Kubernetes</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/introduction/">Documentation</a></li><li class="menu__list-item"><a href="https://github.com/BlackspaceInc/" target="_blank" rel="noopener noreferrer" class="menu__link navbar__item--github">GitHub</a></li><li class="menu__list-item"><a href="https://blackspace.slack.com/join/shared_invite/enQtNzk4Nzg4Mjc2MTE2LTEzZThjMzliMjUzMTBmYzVjYWNmM2UyNWJmNDdkMDYyZmE0ZDliZTQxN2EzNzk5MDE3Zjc1ZmJiZmFiZTIwMGY#/" target="_blank" rel="noopener noreferrer" class="menu__link navbar__item--slack">Join Slack</a></li></ul></div></div></div></nav><div class="wrapper_1hNx"><div class="doc_2sKW"><main class="doc__main_23K2"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Storage model</h1></header><div class="markdown"><p>QuestDB uses a <strong>column-based</strong> storage model. Data is stored in tables with
each column stored in its own file and its own native format. New data is
appended to the bottom of each column to allow data to be organically retrieved
in the same order that it was ingested.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="append-model"></a>Append model<a aria-hidden="true" tabindex="-1" class="hash-link" href="#append-model" title="Direct link to heading">#</a></h2><p>QuestDB appends one column at a time and each one is updated using the same
method. The tail of column file is mapped into the memory page in RAM and the
column append is effectively a memory write at an address. Once the memory page
is exhausted it is unmapped (thus writing data to disk) and a new page is
mapped.</p><p><strong>This method ensures minimum resource churn and consistent append latency.</strong></p><img alt="Architecture of the file storing a column" class="screenshot--shadow screenshot--docs" src="/img/docs/concepts/columnRead.svg"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="read-model"></a>Read model<a aria-hidden="true" tabindex="-1" class="hash-link" href="#read-model" title="Direct link to heading">#</a></h2><p>Table columns are randomly accessible. Columns with fixed size data types are
read by translating the record number into a file offset by a simple bit shift.
The offset in the column file is then translated into an offset in a lazily
mapped memory page, where the required value is read from.</p><img alt="Diagram showing how the data from a column file is mapped to the memory" class="screenshot--shadow screenshot--docs" src="/img/docs/concepts/columnUpdate.svg"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="acid-properties"></a>ACID properties<a aria-hidden="true" tabindex="-1" class="hash-link" href="#acid-properties" title="Direct link to heading">#</a></h2><p>QuestDB utilizes
<a href="https://en.wikipedia.org/wiki/Atomicity_(database_systems)" target="_blank" rel="noopener noreferrer">ACID properties</a>
(Atomicity, Consistency, Isolation, Durability) to ensure data integrity during
a transaction. <strong>QuestDB’s transaction size is only limited by the available
disk space.</strong></p><p>To guarantee <strong>atomicity</strong>, each table maintains a <code>last_committed_record_count</code>
in a separate file. By convention, any table reader will never read more records
than <code>tx_count</code>. This enables the <strong>isolation</strong> property: where uncommitted data
cannot be read. Since uncommitted data is appended directly to the table,</p><p>Once all data is appended, QuestDB <code>commit()</code> ensures that the <code>tx_count</code> is
updated atomically both in multi-threaded and multi-process environments. It
does so <code>lock-free</code> to ensure minimal impact on concurrent reads.</p><p>The <strong>consistency</strong> assurance of the data stored is limited to QuestDB
auto-repairing abnormally terminated transactions. We do not yet support
user-defined constraints, checks and triggers.</p><p>Data <strong>durability</strong> can be configured with <code>commit()</code> optionally being able to
invoke msync() with a choice of synchronous or asynchronous IO.</p><img alt="Diagram of a commit across several column files" class="screenshot--shadow screenshot--docs" src="/img/docs/concepts/commitModel.svg"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="summary"></a>Summary<a aria-hidden="true" tabindex="-1" class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><p>The QuestDB storage model uses memory mapped files and cross-process atomic
transaction updates as a low overhead method of inter-process communication.
Data committed by one process can be instantaneously read by another process
either randomly (via queries) or incrementally (as data queue). QuestDB provides
a variety of reader implementations.</p><img alt="Architecture of the storage model with column files, readers/writers and the mapped memory" class="screenshot--shadow screenshot--docs" src="/img/docs/concepts/storageSummarized.svg"><span></span></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#append-model" class="table-of-contents__link">Append model</a></li><li><a href="#read-model" class="table-of-contents__link">Read model</a></li><li><a href="#acid-properties" class="table-of-contents__link">ACID properties</a></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer_mib0 section_3Kiu"><div class="footer__inner_z0Le section--inner_2xOo"><div class="footer__column_3Npq footer__column--left_1EuR"><img alt="Blackspace logo" class="footer__logo_29Wo" src="/img/navbar/logo.ico" title="Blackspace - Fastest social ecommerce solution for minority owned businesses"><p class="footer__tagline_2F15">Blackspace is the fastest social ecommerce solution for minority owned business owners</p><a class="footer__github_8UHO button_Ni2_ button--icon_3YKU button--secondary_1x2U button--xsmall_3jz_" href="https://github.com/BlackspaceInc/" rel="noopener noreferrer" target="_blank"><img alt="GitHub logo" height="22" src="/img/github.svg" title="GitHub" width="22">Star us on GitHub</a></div><div class="footer__column_3Npq footer__column--right_1XPX"><div class="footer__links_3WB8"><ul class="footer__items_3gGI"><li class="footer__title_1y7h">Blackspace</li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="/docs/introduction/">Documentation</a></li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://github.com/BlackspaceInc//projects/3" rel="noopener noreferrer" target="_blank">Roadmap</a></li></ul></div><div class="footer__links_3WB8"><ul class="footer__items_3gGI"><li class="footer__title_1y7h">Community</li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://blackspace.slack.com/join/shared_invite/enQtNzk4Nzg4Mjc2MTE2LTEzZThjMzliMjUzMTBmYzVjYWNmM2UyNWJmNDdkMDYyZmE0ZDliZTQxN2EzNzk5MDE3Zjc1ZmJiZmFiZTIwMGY#/" rel="noopener noreferrer" target="_blank">Slack</a></li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://twitter.com/blackspace" rel="noopener noreferrer" target="_blank">Twitter</a></li></ul></div><div class="footer__links_3WB8"><ul class="footer__items_3gGI"><li class="footer__title_1y7h">More</li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://github.com/BlackspaceInc/" rel="noopener noreferrer" target="_blank">GitHub</a></li></ul></div></div></div><div class="footer__bottom_2RpL"><p class="footer__copyright_1o2i">Copyright © 2020 Blackspace Platform</p></div></footer></div>
<script src="/styles.c790aa22.js" defer="defer"></script>
<script src="/main.04910a3f.js" defer="defer"></script>
<script src="/common.707bbf35.js" defer="defer"></script>
<script src="/1be78505.7232b9bf.js" defer="defer"></script>
<script src="/935f2afb.5e15d1fa.js" defer="defer"></script>
<script src="/17896441.24ce1f02.js" defer="defer"></script>
<script src="/57aec2a9.4f29313c.js" defer="defer"></script>
</body>
</html>