<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=3">
<meta httpequiv="x-ua-compatible" content="ie=edge">
<meta property="og:type" content="website">
<meta name="author" content="BlackspaceInc">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@Blackspace">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<link href="https://www.googletagmanager.com" rel="dns-prefetch">
<link href="https://www.google-analytics.com" rel="dns-prefetch">
<link rel="shortcut icon" href="https://BlackspaceInc.github.io/img/favicon.png">
<link rel="apple-touch-icon" sizes="48x48" href="/img/icons/icon-48x48.png">
<link rel="apple-touch-icon" sizes="72x72" href="/img/icons/icon-72x72.png">
<link rel="apple-touch-icon" sizes="96x96" href="/img/icons/icon-96x96.png">
<link rel="apple-touch-icon" sizes="144x144" href="/img/icons/icon-144x144.png">
<link rel="apple-touch-icon" sizes="192x192" href="/img/icons/icon-192x192.png">
<link rel="apple-touch-icon" sizes="256x256" href="/img/icons/icon-256x256.png">
<link rel="apple-touch-icon" sizes="384x384" href="/img/icons/icon-384x384.png">
<link rel="apple-touch-icon" sizes="512x512" href="/img/icons/icon-512x512.png">
<link rel="sitemap" type="application/xml" href="/sitemap.xml">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Internal Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Internal Documentation Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-PVR7M2G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-PVR7M2G",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Internal Documentation" href="/opensearch.xml"><title data-react-helmet="true">Common Golang P.R. Reviews | Internal Documentation</title><meta data-react-helmet="true" property="og:image" content="https://BlackspaceInc.github.io/img/og.png"><meta data-react-helmet="true" name="twitter:image" content="https://BlackspaceInc.github.io/img/og.png"><meta data-react-helmet="true" name="twitter:description" content="Blackspace is an ecommerce platform empowering minoriting owned businesses to achieve more"><meta data-react-helmet="true" name="twitter:title" content="Introduction | Internal Documentation"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for &quot;Introduction | Internal Documentation&quot;"><meta data-react-helmet="true" property="og:title" content="Common Golang P.R. Reviews | Internal Documentation"><meta data-react-helmet="true" name="description" content="This set of bulletpoints outline common comments made during reviews of Go code, so that a single detailed explanation can be referred to by shorthands."><meta data-react-helmet="true" property="og:description" content="This set of bulletpoints outline common comments made during reviews of Go code, so that a single detailed explanation can be referred to by shorthands."><meta data-react-helmet="true" property="og:url" content="https://BlackspaceInc.github.io/docs/__guidelines/style_guide/golang/common-review-comments"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://BlackspaceInc.github.io/docs/__guidelines/style_guide/golang/common-review-comments"><link rel="stylesheet" href="/styles.57a3982d.css">
</head>
<body itemscope="" itemtype="http://schema.org/Organization">
<meta itemprop="name" content="Ecommerce platform empowering minority owned businesses to achieve more">
<meta itemprop="description" content="Blackspace is an ecommerce platform empowering minoriting owned businesses to achieve more">
<meta itemprop="url" content="https://BlackspaceInc.github.io">
<meta itemprop="logo" content="https://BlackspaceInc.github.io/img/favicon.png">
<meta itemprop="sameAs" content="https://twitter.com/blackspace">
<meta itemprop="sameAs" content="https://www.linkedin.com/company/blackspaceInc/">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand brand_9Wyn" href="/"><img alt="Blackspace" class="navbar__logo" src="/img/navbar/logo.ico"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Getting Started</a><ul class="dropdown__menu"><li><a class="dropdown__link" position="left" href="/docs/guide/docker/">Docker</a></li><li><a class="dropdown__link" position="left" href="/docs/guide/kubernetes/">Kubernetes</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/BlackspaceInc/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--github">GitHub</a><a href="https://blackspace.slack.com/join/shared_invite/enQtNzk4Nzg4Mjc2MTE2LTEzZThjMzliMjUzMTBmYzVjYWNmM2UyNWJmNDdkMDYyZmE0ZDliZTQxN2EzNzk5MDE3Zjc1ZmJiZmFiZTIwMGY#/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__item--slack">Join Slack</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button><a class="getStarted_1xnS button_Ni2_ button--primary_316O button--uppercase_35Ce button--xsmall_3jz_" href="/getstarted/">Get Started</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand brand_9Wyn" href="/"><img alt="Blackspace" class="navbar__logo" src="/img/navbar/logo.ico"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/guide/docker/">Docker</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/guide/kubernetes/">Kubernetes</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/introduction/">Documentation</a></li><li class="menu__list-item"><a href="https://github.com/BlackspaceInc/" target="_blank" rel="noopener noreferrer" class="menu__link navbar__item--github">GitHub</a></li><li class="menu__list-item"><a href="https://blackspace.slack.com/join/shared_invite/enQtNzk4Nzg4Mjc2MTE2LTEzZThjMzliMjUzMTBmYzVjYWNmM2UyNWJmNDdkMDYyZmE0ZDliZTQxN2EzNzk5MDE3Zjc1ZmJiZmFiZTIwMGY#/" target="_blank" rel="noopener noreferrer" class="menu__link navbar__item--slack">Join Slack</a></li></ul></div></div></div></nav><div class="wrapper_1hNx"><div class="doc_2sKW"><div class="docs-sidebar doc__sidebar_1koD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Guidelines (DEV ONLY)</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Templates</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/__guidelines/template/guide">Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/__guidelines/template/function">Function</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/__guidelines/template/sql">SQL</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Contributing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/__guidelines/contributing">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Releases</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/__guidelines/releasing">Releases</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Reviewing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/__guidelines/reviewing">Reviewing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/__guidelines/security">Security Policy</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Style Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Golang</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/__guidelines/style_guide/golang/clean-code">Clean Go Code</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/__guidelines/style_guide/golang/common-review-comments">Common Golang P.R. Reviews</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/__guidelines/style_guide/golang/golang-styleguide">Blackspace Golang Style Guide</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/__guidelines/naming-convention">Naming convention</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/__guidelines/content-hierarchy">Content hierarchy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/__guidelines/lexicon">Lexicon</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/__guidelines/markdown">Markdown</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/__guidelines/influences">Influences</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/introduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Learning</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Distributed Systems</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/learning/distributed-systems/big-data">Big Data Architectural Patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/learning/distributed-systems/distributed-systems">Distributed Systems Learning Resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/learning/distributed-systems/patterns">Architectural Patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/learning/scalability/scalability">Scalable Systems Resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/learning/distributed-systems/consensus">Distributed Concensus</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Checklists</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Backend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-kubernetes/application-development">Application Development</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-kubernetes/best-practices">Best Practices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-kubernetes/cluster-configuration">Cluster Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-kubernetes/common">Common Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-kubernetes/governance">Namespace Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-kubernetes/patterns">Patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-production-ready/production-ready-checklist">Production Ready Checklist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/backend/backend-security-checklist/production-security-checklist">Security Checklist</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Frontend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/frontend/frontend-design-checklist/frontend-design-checklist">Design Checklist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/frontend/frontend-performance-checklist/frontend-performance-checklist">Performance Checklist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checklists/frontend/frontend-prod-checklist/frontend-prod-checklist">Production Ready Checklist</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Technology</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/architecture/instrumentation/instrumentation">Instrumentation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/architecture/metrics/metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/architecture/service-architecture/service-architecture">Service Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/architecture/service-mesh/service-mesh">Service-Mesh (Linkerd/istio)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Backend Services</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/backend-services/authentication-service/authentication-service">Authentication Microservice</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/backend-services/company-service/company-service">Company Microservice</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/backend-services/email-service/email-service">Email Microservice</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/backend-services/user-service/user-service">User Microservice</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Deployments</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/deployments/deployments">Deployment</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">System Benchmarks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/system-benchmarks/system-benchmark">System Benchmarks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Third Party API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/technology/third-party-apis/third-party-apis">Third Party Api&#x27;s</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Setting up Blackspace</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guide/docker">Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guide/kubernetes">Kubernetes</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Roadmap</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Product Roadmaps</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/roadmap/blackspace-ecommerce/ecommerce-roadmap">Ecommerce Roadmap</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Products</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/ads/ads">Ads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/analytics/analytics">Analytics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/business/business">Business</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/integration/integration">Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/makers/makers">Makers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/marketplace/marketplace">Marketplace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/research/research">Research</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/vc/vc">VC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/products/social/social">Social</a></li></ul></li></ul></li></ul></div></div></div><main class="doc__main_23K2"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Common Golang P.R. Reviews</h1></header><div class="markdown"><p>This set of bulletpoints outline common comments made during reviews of Go code, so that a single detailed explanation can be referred to by shorthands.
This is a laundry list of common mistakes, not a comprehensive style guide.</p><p>You can view this as a supplement to <a href="https://golang.org/doc/effective_go.html" target="_blank" rel="noopener noreferrer">Effective Go</a>.</p><p><strong>Please <a href="https://golang.org/issue/new?title=wiki%3A+CodeReviewComments+change&amp;body=&amp;labels=Documentation" target="_blank" rel="noopener noreferrer">discuss changes</a> before editing this page</strong>, even <em>minor</em> ones. Many people have opinions and this is not the place for edit wars.</p><ul><li><a href="#common-review-comments">Common Review Comments</a></li><li><a href="#gofmt">Gofmt</a></li><li><a href="#comment-sentences">Comment Sentences</a></li><li><a href="#contexts">Contexts</a></li><li><a href="#copying">Copying</a></li><li><a href="#crypto-rand">Crypto Rand</a></li><li><a href="#declaring-empty-slices">Declaring Empty Slices</a></li><li><a href="#doc-comments">Doc Comments</a></li><li><a href="#dont-panic">Don&#x27;t Panic</a></li><li><a href="#error-strings">Error Strings</a></li><li><a href="#examples">Examples</a></li><li><a href="#goroutine-lifetimes">Goroutine Lifetimes</a></li><li><a href="#handle-errors">Handle Errors</a></li><li><a href="#imports">Imports</a></li><li><a href="#import-blank">Import Blank</a></li><li><a href="#import-dot">Import Dot</a></li><li><a href="#in-band-errors">In-Band Errors</a></li><li><a href="#indent-error-flow">Indent Error Flow</a></li><li><a href="#initialisms">Initialisms</a></li><li><a href="#interfaces">Interfaces</a></li><li><a href="#line-length">Line Length</a></li><li><a href="#mixed-caps">Mixed Caps</a></li><li><a href="#named-result-parameters">Named Result Parameters</a></li><li><a href="#naked-returns">Naked Returns</a></li><li><a href="#package-comments">Package Comments</a></li><li><a href="#package-names">Package Names</a></li><li><a href="#pass-values">Pass Values</a></li><li><a href="#receiver-names">Receiver Names</a></li><li><a href="#receiver-type">Receiver Type</a></li><li><a href="#synchronous-functions">Synchronous Functions</a></li><li><a href="#useful-test-failures">Useful Test Failures</a></li><li><a href="#variable-names">Variable Names</a></li><li><a href="#common-mistakes">Common Mistakes</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="gofmt"></a>Gofmt<a aria-hidden="true" tabindex="-1" class="hash-link" href="#gofmt" title="Direct link to heading">#</a></h2><p>Run <a href="https://golang.org/cmd/gofmt/" target="_blank" rel="noopener noreferrer">gofmt</a> on your code to automatically fix the majority of mechanical style issues. Almost all Go code in the wild uses <code>gofmt</code>. The rest of this document addresses non-mechanical style points.</p><p>An alternative is to use <a href="https://godoc.org/golang.org/x/tools/cmd/goimports" target="_blank" rel="noopener noreferrer">goimports</a>, a superset of <code>gofmt</code> which additionally adds (and removes) import lines as necessary.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="comment-sentences"></a>Comment Sentences<a aria-hidden="true" tabindex="-1" class="hash-link" href="#comment-sentences" title="Direct link to heading">#</a></h2><p>See <a href="https://golang.org/doc/effective_go.html#commentary" target="_blank" rel="noopener noreferrer">https://golang.org/doc/effective_go.html#commentary</a>.  Comments documenting declarations should be full sentences, even if that seems a little redundant.  This approach makes them format well when extracted into godoc documentation.  Comments should begin with the name of the thing being described and end in a period:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Request represents a request to run a command.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">type</span><span class="token plain"> Request </span><span class="token keyword" style="color:#ff79c6">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">...</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">// Encode writes the JSON encoding of req to w.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Encode</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">w io</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">Writer</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> req </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Request</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">...</span></div></div></div></div></div><p>and so on.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="contexts"></a>Contexts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#contexts" title="Direct link to heading">#</a></h2><p>Values of the context.Context type carry security credentials,
tracing information, deadlines, and cancellation signals across API
and process boundaries. Go programs pass Contexts explicitly along
the entire function call chain from incoming RPCs and HTTP requests
to outgoing requests.</p><p>Most functions that use a Context should accept it as their first parameter:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-blackspace codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">func F(ctx context.Context, /* other arguments */) {}</span></div></div></div></div></div><p>A function that is never request-specific may use context.Background(),
but err on the side of passing a Context even if you think you don&#x27;t need
to. The default case is to pass a Context; only use context.Background()
directly if you have a good reason why the alternative is a mistake.</p><p>Don&#x27;t add a Context member to a struct type; instead add a ctx parameter
to each method on that type that needs to pass it along. The one exception
is for methods whose signature must match an interface in the standard library
or in a third party library.</p><p>Don&#x27;t create custom Context types or use interfaces other than Context in
function signatures.</p><p>If you have application data to pass around, put it in a parameter,
in the receiver, in globals, or, if it truly belongs there, in a Context value.</p><p>Contexts are immutable, so it&#x27;s fine to pass the same ctx to multiple
calls that share the same deadline, cancellation signal, credentials,
parent trace, etc.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="copying"></a>Copying<a aria-hidden="true" tabindex="-1" class="hash-link" href="#copying" title="Direct link to heading">#</a></h2><p>To avoid unexpected aliasing, be careful when copying a struct from another package.
For example, the bytes.Buffer type contains a <code>[]byte</code> slice. If you copy a <code>Buffer</code>,
the slice in the copy may alias the array in the original, causing subsequent method
calls to have surprising effects.</p><p>In general, do not copy a value of type <code>T</code> if its methods are associated with the
pointer type, <code>*T</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="crypto-rand"></a>Crypto Rand<a aria-hidden="true" tabindex="-1" class="hash-link" href="#crypto-rand" title="Direct link to heading">#</a></h2><p>Do not use package <code>math/rand</code> to generate keys, even throwaway ones.
Unseeded, the generator is completely predictable. Seeded with <code>time.Nanoseconds()</code>,
there are just a few bits of entropy. Instead, use <code>crypto/rand</code>&#x27;s Reader,
and if you need text, print to hexadecimal or base64:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;crypto/rand&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// &quot;encoding/base64&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// &quot;encoding/hex&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Key</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    buf </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">make</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token builtin" style="color:#bd93f9">byte</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">16</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token boolean" style="color:#bd93f9">_</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> rand</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Read</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#8be9fd">panic</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain">  </span><span class="token comment" style="color:#6272a4">// out of randomness, should never happen</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Sprintf</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;%x&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// or hex.EncodeToString(buf)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// or base64.StdEncoding.EncodeToString(buf)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="declaring-empty-slices"></a>Declaring Empty Slices<a aria-hidden="true" tabindex="-1" class="hash-link" href="#declaring-empty-slices" title="Direct link to heading">#</a></h2><p>When declaring an empty slice, prefer</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">var</span><span class="token plain"> t </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token builtin" style="color:#bd93f9">string</span></div></div></div></div></div><p>over </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">t </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token builtin" style="color:#bd93f9">string</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>The former declares a nil slice value, while the latter is non-nil but zero-length. They are functionally equivalent—their <code>len</code> and <code>cap</code> are both zero—but the nil slice is the preferred style.</p><p>Note that there are limited circumstances where a non-nil but zero-length slice is preferred, such as when encoding JSON objects (a <code>nil</code> slice encodes to <code>null</code>, while <code>[]string{}</code> encodes to the JSON array <code>[]</code>).</p><p>When designing interfaces, avoid making a distinction between a nil slice and a non-nil, zero-length slice, as this can lead to subtle programming errors.</p><p>For more discussion about nil in Go see Francesc Campoy&#x27;s talk <a href="https://www.youtube.com/watch?v=ynoY2xz-F8s" target="_blank" rel="noopener noreferrer">Understanding Nil</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="doc-comments"></a>Doc Comments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#doc-comments" title="Direct link to heading">#</a></h2><p>All top-level, exported names should have doc comments, as should non-trivial unexported type or function declarations. See <a href="https://golang.org/doc/effective_go.html#commentary" target="_blank" rel="noopener noreferrer">https://golang.org/doc/effective_go.html#commentary</a> for more information about commentary conventions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dont-panic"></a>Don&#x27;t Panic<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dont-panic" title="Direct link to heading">#</a></h2><p>See <a href="https://golang.org/doc/effective_go.html#errors" target="_blank" rel="noopener noreferrer">https://golang.org/doc/effective_go.html#errors</a>. Don&#x27;t use panic for normal error handling. Use error and multiple return values.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="error-strings"></a>Error Strings<a aria-hidden="true" tabindex="-1" class="hash-link" href="#error-strings" title="Direct link to heading">#</a></h2><p>Error strings should not be capitalized (unless beginning with proper nouns or acronyms) or end with punctuation, since they are usually printed following other context. That is, use <code>fmt.Errorf(&quot;something bad&quot;)</code> not <code>fmt.Errorf(&quot;Something bad&quot;)</code>, so that <code>log.Printf(&quot;Reading %s: %v&quot;, filename, err)</code> formats without a spurious capital letter mid-message. This does not apply to logging, which is implicitly line-oriented and not combined inside other messages.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="examples"></a>Examples<a aria-hidden="true" tabindex="-1" class="hash-link" href="#examples" title="Direct link to heading">#</a></h2><p>When adding a new package, include examples of intended usage: a runnable Example,
or a simple test demonstrating a complete call sequence.</p><p>Read more about <a href="https://blog.golang.org/examples" target="_blank" rel="noopener noreferrer">testable Example() functions</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="goroutine-lifetimes"></a>Goroutine Lifetimes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#goroutine-lifetimes" title="Direct link to heading">#</a></h2><p>When you spawn goroutines, make it clear when - or whether - they exit.</p><p>Goroutines can leak by blocking on channel sends or receives: the garbage collector
will not terminate a goroutine even if the channels it is blocked on are unreachable.</p><p>Even when goroutines do not leak, leaving them in-flight when they are no longer
needed can cause other subtle and hard-to-diagnose problems. Sends on closed channels
panic. Modifying still-in-use inputs &quot;after the result isn&#x27;t needed&quot; can still lead
to data races. And leaving goroutines in-flight for arbitrarily long can lead to
unpredictable memory usage.</p><p>Try to keep concurrent code simple enough that goroutine lifetimes are obvious.
If that just isn&#x27;t feasible, document when and why the goroutines exit.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="handle-errors"></a>Handle Errors<a aria-hidden="true" tabindex="-1" class="hash-link" href="#handle-errors" title="Direct link to heading">#</a></h2><p>See <a href="https://golang.org/doc/effective_go.html#errors" target="_blank" rel="noopener noreferrer">https://golang.org/doc/effective_go.html#errors</a>. Do not discard errors using <code>_</code> variables. If a function returns an error, check it to make sure the function succeeded. Handle the error, return it, or, in truly exceptional situations, panic.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="imports"></a>Imports<a aria-hidden="true" tabindex="-1" class="hash-link" href="#imports" title="Direct link to heading">#</a></h2><p>Avoid renaming imports except to avoid a name collision; good package names
should not require renaming. In the event of collision, prefer to rename the most
local or project-specific import.</p><p>Imports are organized in groups, with blank lines between them.
The standard library packages are always in the first group.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;hash/adler32&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;os&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;appengine/foo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;appengine/user&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;github.com/foo/bar&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;rsc.io/goversion/version&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div></div></div><a href="https://godoc.org/golang.org/x/tools/cmd/goimports" target="_blank" rel="noopener noreferrer">goimports</a> will do this for you.<h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="import-blank"></a>Import Blank<a aria-hidden="true" tabindex="-1" class="hash-link" href="#import-blank" title="Direct link to heading">#</a></h2><p>Packages that are imported only for their side effects (using the syntax <code>import
_ &quot;pkg&quot;</code>) should only be imported in the main package of a program, or in tests
that require them.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="import-dot"></a>Import Dot<a aria-hidden="true" tabindex="-1" class="hash-link" href="#import-dot" title="Direct link to heading">#</a></h2><p>The import . form can be useful in tests that, due to circular dependencies, cannot be made part of the package being tested:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> foo_test</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#f1fa8c">&quot;bar/testutil&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#6272a4">// also imports &quot;foo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;foo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div></div></div><p>In this case, the test file cannot be in package foo because it uses bar/testutil, which imports foo.  So we use the &#x27;import .&#x27; form to let the file pretend to be part of package foo even though it is not.  Except for this one case, do not use import . in your programs.  It makes the programs much harder to read because it is unclear whether a name like Quux is a top-level identifier in the current package or in an imported package.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="in-band-errors"></a>In-Band Errors<a aria-hidden="true" tabindex="-1" class="hash-link" href="#in-band-errors" title="Direct link to heading">#</a></h2><p>In C and similar languages, it&#x27;s common for functions to return values like -1
or null to signal errors or missing results:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Lookup returns the value for key or &quot;&quot; if there is no mapping for key.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Lookup</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">key </span><span class="token builtin" style="color:#bd93f9">string</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">string</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">// Failing to check a for an in-band error value can lead to bugs:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#8be9fd">Parse</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token function" style="color:#8be9fd">Lookup</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain">  </span><span class="token comment" style="color:#6272a4">// returns &quot;parse failure for value&quot; instead of &quot;no value for key&quot;</span></div></div></div></div></div><p>Go&#x27;s support for multiple return values provides a better solution.
Instead of requiring clients to check for an in-band error value, a function should return
an additional value to indicate whether its other return values are valid. This return
value may be an error, or a boolean when no explanation is needed.
It should be the final return value.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Lookup returns the value for key or ok=false if there is no mapping for key.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Lookup</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">key </span><span class="token builtin" style="color:#bd93f9">string</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">value </span><span class="token builtin" style="color:#bd93f9">string</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> ok </span><span class="token builtin" style="color:#bd93f9">bool</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div></div></div><p>This prevents the caller from using the result incorrectly:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#8be9fd">Parse</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token function" style="color:#8be9fd">Lookup</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain">  </span><span class="token comment" style="color:#6272a4">// compile-time error</span></div></div></div></div></div><p>And encourages more robust and readable code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">value</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> ok </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Lookup</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">!</span><span class="token plain">ok </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Errorf</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;no value for %q&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Parse</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div></div></div><p>This rule applies to exported functions but is also useful
for unexported functions.</p><p>Return values like nil, &quot;&quot;, 0, and -1 are fine when they are
valid results for a function, that is, when the caller need not
handle them differently from other values.</p><p>Some standard library functions, like those in package &quot;strings&quot;,
return in-band error values. This greatly simplifies string-manipulation
code at the cost of requiring more diligence from the programmer.
In general, Go code should return additional values for errors.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="indent-error-flow"></a>Indent Error Flow<a aria-hidden="true" tabindex="-1" class="hash-link" href="#indent-error-flow" title="Direct link to heading">#</a></h2><p>Try to keep the normal code path at a minimal indentation, and indent the error handling, dealing with it first. This improves the readability of the code by permitting visually scanning the normal path quickly. For instance, don&#x27;t write:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// error handling</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// normal code</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>Instead, write:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// error handling</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"> </span><span class="token comment" style="color:#6272a4">// or continue, etc.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">// normal code</span></div></div></div></div></div><p>If the <code>if</code> statement has an initialization statement, such as:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> x</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">f</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// error handling</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// use x</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>then this may require moving the short variable declaration to its own line:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">x</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">f</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> err </span><span class="token operator" style="color:#ff79c6">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">// error handling</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">// use x</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="initialisms"></a>Initialisms<a aria-hidden="true" tabindex="-1" class="hash-link" href="#initialisms" title="Direct link to heading">#</a></h2><p>Words in names that are initialisms or acronyms (e.g. &quot;URL&quot; or &quot;NATO&quot;) have a consistent case. For example, &quot;URL&quot; should appear as &quot;URL&quot; or &quot;url&quot; (as in &quot;urlPony&quot;, or &quot;URLPony&quot;), never as &quot;Url&quot;. As an example: ServeHTTP not ServeHttp. For identifiers with multiple initialized &quot;words&quot;, use for example &quot;xmlHTTPRequest&quot; or &quot;XMLHTTPRequest&quot;.</p><p>This rule also applies to &quot;ID&quot; when it is short for &quot;identifier&quot; (which is pretty much all cases when it&#x27;s not the &quot;id&quot; as in &quot;ego&quot;, &quot;superego&quot;), so write &quot;appID&quot; instead of &quot;appId&quot;.</p><p>Code generated by the protocol buffer compiler is exempt from this rule. Human-written code is held to a higher standard than machine-written code.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="interfaces"></a>Interfaces<a aria-hidden="true" tabindex="-1" class="hash-link" href="#interfaces" title="Direct link to heading">#</a></h2><p>Go interfaces generally belong in the package that uses values of the
interface type, not the package that implements those values. The
implementing package should return concrete (usually pointer or struct)
types: that way, new methods can be added to implementations without
requiring extensive refactoring.</p><p>Do not define interfaces on the implementor side of an API &quot;for mocking&quot;;
instead, design the API so that it can be tested using the public API of
the real implementation.</p><p>Do not define interfaces before they are used: without a realistic example
of usage, it is too difficult to see whether an interface is even necessary,
let alone what methods it ought to contain.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> consumer  </span><span class="token comment" style="color:#6272a4">// consumer.go</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">type</span><span class="token plain"> Thinger </span><span class="token keyword" style="color:#ff79c6">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Thing</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Foo</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t Thinger</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> consumer </span><span class="token comment" style="color:#6272a4">// consumer_test.go</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">type</span><span class="token plain"> fakeThinger </span><span class="token keyword" style="color:#ff79c6">struct</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t fakeThinger</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Thing</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">…</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Foo</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">fakeThinger</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain">…</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">==</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;x&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// DO NOT DO IT!!!</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> producer</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">type</span><span class="token plain"> Thinger </span><span class="token keyword" style="color:#ff79c6">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Thing</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">type</span><span class="token plain"> defaultThinger </span><span class="token keyword" style="color:#ff79c6">struct</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t defaultThinger</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Thing</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">NewThinger</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> Thinger </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"> defaultThinger</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>Instead return a concrete type and let the consumer mock the producer implementation.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> producer</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">type</span><span class="token plain"> Thinger </span><span class="token keyword" style="color:#ff79c6">struct</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t Thinger</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Thing</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">NewThinger</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> Thinger </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">return</span><span class="token plain"> Thinger</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> … </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="line-length"></a>Line Length<a aria-hidden="true" tabindex="-1" class="hash-link" href="#line-length" title="Direct link to heading">#</a></h2><p>There is no rigid line length limit in Go code, but avoid uncomfortably long lines.
Similarly, don&#x27;t add line breaks to keep lines short when they are more readable long--for example,
if they are repetitive.</p><p>Most of the time when people wrap lines &quot;unnaturally&quot; (in the middle of function calls or
function declarations, more or less, say, though some exceptions are around), the wrapping would be
unnecessary if they had a reasonable number of parameters and reasonably short variable names.
Long lines seem to go with long names, and getting rid of the long names helps a lot.</p><p>In other words, break lines because of the semantics of what you&#x27;re writing (as a general rule)
and not because of the length of the line. If you find that this produces lines that are too long,
then change the names or the semantics and you&#x27;ll probably get a good result.</p><p>This is, actually, exactly the same advice about how long a function should be. There&#x27;s no rule
&quot;never have a function more than N lines long&quot;, but there is definitely such a thing as too long
of a function, and of too stuttery tiny functions, and the solution is to change where the function
boundaries are, not to start counting lines.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mixed-caps"></a>Mixed Caps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mixed-caps" title="Direct link to heading">#</a></h2><p>See <a href="https://golang.org/doc/effective_go.html#mixed-caps" target="_blank" rel="noopener noreferrer">https://golang.org/doc/effective_go.html#mixed-caps</a>. This applies even when it breaks conventions in other languages. For example an unexported constant is <code>maxLength</code> not <code>MaxLength</code> or <code>MAX_LENGTH</code>.</p><p>Also see <a href="https://github.com/golang/go/wiki/CodeReviewComments#initialisms" target="_blank" rel="noopener noreferrer">Initialisms</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="named-result-parameters"></a>Named Result Parameters<a aria-hidden="true" tabindex="-1" class="hash-link" href="#named-result-parameters" title="Direct link to heading">#</a></h2><p>Consider what it will look like in godoc.  Named result parameters like:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">n </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Parent1</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">node </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">n </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Parent2</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">node </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> err </span><span class="token builtin" style="color:#bd93f9">error</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>will stutter in godoc; better to use:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">n </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Parent1</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">n </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Parent2</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Node</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">error</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>On the other hand, if a function returns two or three parameters of the same type,
or if the meaning of a result isn&#x27;t clear from context, adding names may be useful
in some contexts. Don&#x27;t name result parameters just to avoid declaring a var inside
the function; that trades off a minor implementation brevity at the cost of
unnecessary API verbosity.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Foo</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Location</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token builtin" style="color:#bd93f9">float64</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">float64</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">error</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div></div></div><p>is less clear than:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Location returns f&#x27;s latitude and longitude.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">// Negative values mean south and west, respectively.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">f </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">Foo</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">Location</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">lat</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> long </span><span class="token builtin" style="color:#bd93f9">float64</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> err </span><span class="token builtin" style="color:#bd93f9">error</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div></div></div><p>Naked returns are okay if the function is a handful of lines. Once it&#x27;s a medium
sized function, be explicit with your return values. Corollary: it&#x27;s not worth it
to name result parameters just because it enables you to use naked returns.
Clarity of docs is always more important than saving a line or two in your function.</p><p>Finally, in some cases you need to name a result parameter in order to change
it in a deferred closure. That is always OK.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="naked-returns"></a>Naked Returns<a aria-hidden="true" tabindex="-1" class="hash-link" href="#naked-returns" title="Direct link to heading">#</a></h2><p>See <a href="#named-result-parameters">Named Result Parameters</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="package-comments"></a>Package Comments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#package-comments" title="Direct link to heading">#</a></h2><p>Package comments, like all comments to be presented by godoc, must appear adjacent to the package clause, with no blank line.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Package math provides basic constants and mathematical functions.</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> math</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">/*</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">Package template implements data-driven templates for generating textual</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">output such as HTML.</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">....</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> template</span></div></div></div></div></div><p>For &quot;package main&quot; comments, other styles of comment are fine after the binary name (and it may be capitalized if it comes first), For example, for a <code>package main</code> in the directory <code>seedgen</code> you could write:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Binary seedgen ...</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> main</span></div></div></div></div></div><p>or</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Command seedgen ...</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> main</span></div></div></div></div></div><p>or</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Program seedgen ...</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> main</span></div></div></div></div></div><p>or</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// The seedgen command ...</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> main</span></div></div></div></div></div><p>or</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// The seedgen program ...</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> main</span></div></div></div></div></div><p>or</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">// Seedgen ..</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">package</span><span class="token plain"> main</span></div></div></div></div></div><p>These are examples, and sensible variants of these are acceptable.</p><p>Note that starting the sentence with a lower-case word is not among the
acceptable options for package comments, as these are publicly-visible and
should be written in proper English, including capitalizing the first word
of the sentence. When the binary name is the first word, capitalizing it is
required even though it does not strictly match the spelling of the
command-line invocation.</p><p>See <a href="https://golang.org/doc/effective_go.html#commentary" target="_blank" rel="noopener noreferrer">https://golang.org/doc/effective_go.html#commentary</a> for more information about commentary conventions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="package-names"></a>Package Names<a aria-hidden="true" tabindex="-1" class="hash-link" href="#package-names" title="Direct link to heading">#</a></h2><p>All references to names in your package will be done using the package name,
so you can omit that name from the identifiers. For example, if you are in package chubby,
you don&#x27;t need type ChubbyFile, which clients will write as <code>chubby.ChubbyFile</code>.
Instead, name the type <code>File</code>, which clients will write as <code>chubby.File</code>.
Avoid meaningless package names like util, common, misc, api, types, and interfaces. See <a href="http://golang.org/doc/effective_go.html#package-names" target="_blank" rel="noopener noreferrer">http://golang.org/doc/effective_go.html#package-names</a> and
<a href="http://blog.golang.org/package-names" target="_blank" rel="noopener noreferrer">http://blog.golang.org/package-names</a> for more.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pass-values"></a>Pass Values<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pass-values" title="Direct link to heading">#</a></h2><p>Don&#x27;t pass pointers as function arguments just to save a few bytes.  If a function refers to its argument <code>x</code> only as <code>*x</code> throughout, then the argument shouldn&#x27;t be a pointer.  Common instances of this include passing a pointer to a string (<code>*string</code>) or a pointer to an interface value (<code>*io.Reader</code>).  In both cases the value itself is a fixed size and can be passed directly.  This advice does not apply to large structs, or even small structs that might grow.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="receiver-names"></a>Receiver Names<a aria-hidden="true" tabindex="-1" class="hash-link" href="#receiver-names" title="Direct link to heading">#</a></h2><p>The name of a method&#x27;s receiver should be a reflection of its identity; often a one or two letter abbreviation of its type suffices (such as &quot;c&quot; or &quot;cl&quot; for &quot;Client&quot;). Don&#x27;t use generic names such as &quot;me&quot;, &quot;this&quot; or &quot;self&quot;, identifiers typical of object-oriented languages that gives the method a special meaning. In Go, the receiver of a method is just another parameter and therefore, should be named accordingly. The name need not be as descriptive as that of a method argument, as its role is obvious and serves no documentary purpose. It can be very short as it will appear on almost every line of every method of the type; familiarity admits brevity. Be consistent, too: if you call the receiver &quot;c&quot; in one method, don&#x27;t call it &quot;cl&quot; in another.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="receiver-type"></a>Receiver Type<a aria-hidden="true" tabindex="-1" class="hash-link" href="#receiver-type" title="Direct link to heading">#</a></h2><p>Choosing whether to use a value or pointer receiver on methods can be difficult, especially to new Go programmers.  If in doubt, use a pointer, but there are times when a value receiver makes sense, usually for reasons of efficiency, such as for small unchanging structs or values of basic type. Some useful guidelines:</p><ul><li>If the receiver is a map, func or chan, don&#x27;t use a pointer to them. If the receiver is a slice and the method doesn&#x27;t reslice or reallocate the slice, don&#x27;t use a pointer to it.</li><li>If the method needs to mutate the receiver, the receiver must be a pointer.</li><li>If the receiver is a struct that contains a sync.Mutex or similar synchronizing field, the receiver must be a pointer to avoid copying.</li><li>If the receiver is a large struct or array, a pointer receiver is more efficient.  How large is large?  Assume it&#x27;s equivalent to passing all its elements as arguments to the method.  If that feels too large, it&#x27;s also too large for the receiver.</li><li>Can function or methods, either concurrently or when called from this method, be mutating the receiver? A value type creates a copy of the receiver when the method is invoked, so outside updates will not be applied to this receiver. If changes must be visible in the original receiver, the receiver must be a pointer.</li><li>If the receiver is a struct, array or slice and any of its elements is a pointer to something that might be mutating, prefer a pointer receiver, as it will make the intention more clear to the reader.</li><li>If the receiver is a small array or struct that is naturally a value type (for instance, something like the time.Time type), with no mutable fields and no pointers, or is just a simple basic type such as int or string, a value receiver makes sense.  A value receiver can reduce the amount of garbage that can be generated; if a value is passed to a value method, an on-stack copy can be used instead of allocating on the heap. (The compiler tries to be smart about avoiding this allocation, but it can&#x27;t always succeed.) Don&#x27;t choose a value receiver type for this reason without profiling first.</li><li>Finally, when in doubt, use a pointer receiver.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="synchronous-functions"></a>Synchronous Functions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#synchronous-functions" title="Direct link to heading">#</a></h2><p>Prefer synchronous functions - functions which return their results directly or finish any callbacks or channel ops before returning - over asynchronous ones.</p><p>Synchronous functions keep goroutines localized within a call, making it easier to reason about their lifetimes and avoid leaks and data races. They&#x27;re also easier to test: the caller can pass an input and check the output without the need for polling or synchronization.</p><p>If callers need more concurrency, they can add it easily by calling the function from a separate goroutine. But it is quite difficult - sometimes impossible - to remove unnecessary concurrency at the caller side.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="useful-test-failures"></a>Useful Test Failures<a aria-hidden="true" tabindex="-1" class="hash-link" href="#useful-test-failures" title="Direct link to heading">#</a></h2><p>Tests should fail with helpful messages saying what was wrong, with what inputs, what was actually got, and what was expected.  It may be tempting to write a bunch of assertFoo helpers, but be sure your helpers produce useful error messages.  Assume that the person debugging your failing test is not you, and is not your team.  A typical Go test fails like:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> got </span><span class="token operator" style="color:#ff79c6">!=</span><span class="token plain"> tt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">want </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    t</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Errorf</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;Foo(%q) = %d; want %d&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> tt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">in</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> got</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> tt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">want</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token comment" style="color:#6272a4">// or Fatalf, if test can&#x27;t test anything more past this point</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>Note that the order here is actual != expected, and the message uses that order too. Some test frameworks encourage writing these backwards: 0 != x, &quot;expected 0, got x&quot;, and so on. Go does not.</p><p>If that seems like a lot of typing, you may want to write a [[table-driven test|TableDrivenTests]].</p><p>Another common technique to disambiguate failing tests when using a test helper with different input is to wrap each caller with a different TestFoo function, so the test fails with that name:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">TestSingleValue</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">testing</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">testHelper</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token builtin" style="color:#bd93f9">int</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token number" style="color:#50fa7b">80</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">TestNoValues</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">testing</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">testHelper</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token builtin" style="color:#bd93f9">int</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>In any case, the onus is on you to fail with a helpful message to whoever&#x27;s debugging your code in the future.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="variable-names"></a>Variable Names<a aria-hidden="true" tabindex="-1" class="hash-link" href="#variable-names" title="Direct link to heading">#</a></h2><p>Variable names in Go should be short rather than long.  This is especially true for local variables with limited scope.  Prefer <code>c</code> to <code>lineCount</code>.  Prefer <code>i</code> to <code>sliceIndex</code>.</p><p>The basic rule: the further from its declaration that a name is used, the more descriptive the name must be. For a method receiver, one or two letters is sufficient. Common variables such as loop indices and readers can be a single letter (<code>i</code>, <code>r</code>). More unusual things and global variables need more descriptive names.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="common-mistakes"></a>Common Mistakes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#common-mistakes" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-reference-to-loop-iterator-variable"></a>Using reference to loop iterator variable<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-reference-to-loop-iterator-variable" title="Direct link to heading">#</a></h3><p>In Go, the loop iterator variable is a single variable that takes different values in each loop iteration. This is very efficient, but might lead to unintended behavior when used incorrectly. For example, see the following program:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">main</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">var</span><span class="token plain"> out </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token operator" style="color:#ff79c6">*</span><span class="token builtin" style="color:#bd93f9">int</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> i </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"> i </span><span class="token operator" style="color:#ff79c6">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">3</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"> i</span><span class="token operator" style="color:#ff79c6">++</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        out </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">append</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">out</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">&amp;</span><span class="token plain">i</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;Values:&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">out</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">out</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">out</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">2</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;Addresses:&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> out</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> out</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> out</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">2</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>It will output unexpected results:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-blackspace codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">Values: 3 3 3</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">Addresses: 0x40e020 0x40e020 0x40e020</span></div></div></div></div></div><p>Explanation: in each iteration we append the address of <code>i</code> to the <code>out</code> slice, but since it is the same variable, we append the same address which eventually contains the last value that was assigned to <code>i</code>. One of the solutions is to copy the loop variable into a new variable:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"> for i := 0; i &lt; 3; i++ {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:#8be9fd">+   i := i // Copy i into a new variable.</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#8be9fd"></span><span class="token unchanged">    out = append(out, &amp;i)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"> }</span></div></div></div></div></div><p>The new output of the program is what was expected:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-blackspace codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">Values: 0 1 2</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">Addresses: 0x40e020 0x40e024 0x40e028</span></div></div></div></div></div><p>Explanation: the line <code>i := i</code> copies the loop variable <code>i</code> into a new variable scoped to the for loop body block, also called <code>i</code>. The address of the new variable is the one that is appended to the array, which makes it outlive the for loop body block. In each loop iteration a new variable is created.</p><p>While this example might look a bit obvious, the same unexpected behavior could be more hidden in some other cases. For example, the loop variable can be an array and the reference can be a slice:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">main</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">var</span><span class="token plain"> out </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token builtin" style="color:#bd93f9">int</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">_</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> i </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">range</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token builtin" style="color:#bd93f9">int</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token number" style="color:#50fa7b">2</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token number" style="color:#50fa7b">3</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        out </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">append</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">out</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;Values:&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> out</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>Output:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-blackspace codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">Values: [[3] [3] [3]]</span></div></div></div></div></div><p>The same issue can be demonstrated also when the loop variable is being used in a Goroutine (see the following section).</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-goroutines-on-loop-iterator-variables"></a>Using goroutines on loop iterator variables<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-goroutines-on-loop-iterator-variables" title="Direct link to heading">#</a></h1><p>When iterating in Go, one might attempt to use goroutines to process data in parallel. For example, you might write something like this, using a closure:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">_</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> val </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">range</span><span class="token plain"> values </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">go</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">func</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>The above for loops might not do what you expect because their <code>val</code> variable is actually a single variable that takes on the value of each slice element. Because the closures are all only bound to that one variable, there is a very good chance that when you run this code you will see the last element printed for every iteration instead of each value in sequence, because the goroutines will probably not begin executing until after the loop.</p><p>The proper way to write that closure loop is:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">_</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> val </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">range</span><span class="token plain"> values </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">go</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">func</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">val </span><span class="token keyword" style="color:#ff79c6">interface</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>By adding val as a parameter to the closure, <code>val</code> is evaluated at each iteration and placed on the stack for the goroutine, so each slice element is available to the goroutine when it is eventually executed.</p><p>It is also important to note that variables declared within the body of a loop are not shared between iterations, and thus can be used separately in a closure.  The following code uses a common index variable <code>i</code> to create separate <code>val</code>s, which results in the expected behavior:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> i </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">range</span><span class="token plain"> valslice </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    val </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> valslice</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">go</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">func</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>Note that without executing this closure as a goroutine, the code runs as expected.  The following example prints out the integers between 1 and 10.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> i </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"> i </span><span class="token operator" style="color:#ff79c6">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">10</span><span class="token punctuation" style="color:#f8f8f2">;</span><span class="token plain"> i</span><span class="token operator" style="color:#ff79c6">++</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">func</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>Even though the closures all still close over the same variable (in this case, <code>i</code>), they are executed before the variable changes, resulting in the desired behavior.
<a href="http://golang.org/doc/go_faq.html#closures_and_goroutines" target="_blank" rel="noopener noreferrer">http://golang.org/doc/go_faq.html#closures_and_goroutines</a></p><p>You may find another, similar situation like the following:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">_</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> val </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">range</span><span class="token plain"> values </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">go</span><span class="token plain"> val</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">MyMethod</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">v </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">val</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">MyMethod</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">v</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><p>The above example also will print last element of values, the reason is same as closure. To fix the issue declare another variable inside the loop. </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-go codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">_</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> val </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">range</span><span class="token plain"> values </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        newVal </span><span class="token operator" style="color:#ff79c6">:=</span><span class="token plain"> val</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">go</span><span class="token plain"> newVal</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">MyMethod</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">v </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain">val</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token function" style="color:#8be9fd">MyMethod</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#8be9fd">Println</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">v</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/__guidelines/style_guide/golang/clean-code"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Clean Go Code</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/__guidelines/style_guide/golang/golang-styleguide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Blackspace Golang Style Guide »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#gofmt" class="table-of-contents__link">Gofmt</a></li><li><a href="#comment-sentences" class="table-of-contents__link">Comment Sentences</a></li><li><a href="#contexts" class="table-of-contents__link">Contexts</a></li><li><a href="#copying" class="table-of-contents__link">Copying</a></li><li><a href="#crypto-rand" class="table-of-contents__link">Crypto Rand</a></li><li><a href="#declaring-empty-slices" class="table-of-contents__link">Declaring Empty Slices</a></li><li><a href="#doc-comments" class="table-of-contents__link">Doc Comments</a></li><li><a href="#dont-panic" class="table-of-contents__link">Don&#39;t Panic</a></li><li><a href="#error-strings" class="table-of-contents__link">Error Strings</a></li><li><a href="#examples" class="table-of-contents__link">Examples</a></li><li><a href="#goroutine-lifetimes" class="table-of-contents__link">Goroutine Lifetimes</a></li><li><a href="#handle-errors" class="table-of-contents__link">Handle Errors</a></li><li><a href="#imports" class="table-of-contents__link">Imports</a></li><li><a href="#import-blank" class="table-of-contents__link">Import Blank</a></li><li><a href="#import-dot" class="table-of-contents__link">Import Dot</a></li><li><a href="#in-band-errors" class="table-of-contents__link">In-Band Errors</a></li><li><a href="#indent-error-flow" class="table-of-contents__link">Indent Error Flow</a></li><li><a href="#initialisms" class="table-of-contents__link">Initialisms</a></li><li><a href="#interfaces" class="table-of-contents__link">Interfaces</a></li><li><a href="#line-length" class="table-of-contents__link">Line Length</a></li><li><a href="#mixed-caps" class="table-of-contents__link">Mixed Caps</a></li><li><a href="#named-result-parameters" class="table-of-contents__link">Named Result Parameters</a></li><li><a href="#naked-returns" class="table-of-contents__link">Naked Returns</a></li><li><a href="#package-comments" class="table-of-contents__link">Package Comments</a></li><li><a href="#package-names" class="table-of-contents__link">Package Names</a></li><li><a href="#pass-values" class="table-of-contents__link">Pass Values</a></li><li><a href="#receiver-names" class="table-of-contents__link">Receiver Names</a></li><li><a href="#receiver-type" class="table-of-contents__link">Receiver Type</a></li><li><a href="#synchronous-functions" class="table-of-contents__link">Synchronous Functions</a></li><li><a href="#useful-test-failures" class="table-of-contents__link">Useful Test Failures</a></li><li><a href="#variable-names" class="table-of-contents__link">Variable Names</a></li><li><a href="#common-mistakes" class="table-of-contents__link">Common Mistakes</a><ul><li><a href="#using-reference-to-loop-iterator-variable" class="table-of-contents__link">Using reference to loop iterator variable</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer_mib0 section_3Kiu"><div class="footer__inner_z0Le section--inner_2xOo"><div class="footer__column_3Npq footer__column--left_1EuR"><img alt="Blackspace logo" class="footer__logo_29Wo" src="/img/navbar/logo.ico" title="Blackspace - Fastest social ecommerce solution for minority owned businesses"><p class="footer__tagline_2F15">Blackspace is the fastest social ecommerce solution for minority owned business owners</p><a class="footer__github_8UHO button_Ni2_ button--icon_3YKU button--secondary_1x2U button--xsmall_3jz_" href="https://github.com/BlackspaceInc/" rel="noopener noreferrer" target="_blank"><img alt="GitHub logo" height="22" src="/img/github.svg" title="GitHub" width="22">Star us on GitHub</a></div><div class="footer__column_3Npq footer__column--right_1XPX"><div class="footer__links_3WB8"><ul class="footer__items_3gGI"><li class="footer__title_1y7h">Blackspace</li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="/docs/introduction/">Documentation</a></li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://github.com/BlackspaceInc//projects/3" rel="noopener noreferrer" target="_blank">Roadmap</a></li></ul></div><div class="footer__links_3WB8"><ul class="footer__items_3gGI"><li class="footer__title_1y7h">Community</li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://blackspace.slack.com/join/shared_invite/enQtNzk4Nzg4Mjc2MTE2LTEzZThjMzliMjUzMTBmYzVjYWNmM2UyNWJmNDdkMDYyZmE0ZDliZTQxN2EzNzk5MDE3Zjc1ZmJiZmFiZTIwMGY#/" rel="noopener noreferrer" target="_blank">Slack</a></li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://twitter.com/blackspace" rel="noopener noreferrer" target="_blank">Twitter</a></li></ul></div><div class="footer__links_3WB8"><ul class="footer__items_3gGI"><li class="footer__title_1y7h">More</li><li class="footer__item_1JzF"><a class="footer__link_2PDg" href="https://github.com/BlackspaceInc/" rel="noopener noreferrer" target="_blank">GitHub</a></li></ul></div></div></div><div class="footer__bottom_2RpL"><p class="footer__copyright_1o2i">Copyright © 2020 Blackspace Platform</p></div></footer></div>
<script src="/styles.9b222ab6.js" defer="defer"></script>
<script src="/main.80a0892d.js" defer="defer"></script>
<script src="/common.8589eeb4.js" defer="defer"></script>
<script src="/1be78505.eb7c44d5.js" defer="defer"></script>
<script src="/935f2afb.56a3b6d3.js" defer="defer"></script>
<script src="/17896441.80fcc57a.js" defer="defer"></script>
<script src="/98e4d260.b4e73729.js" defer="defer"></script>
</body>
</html>